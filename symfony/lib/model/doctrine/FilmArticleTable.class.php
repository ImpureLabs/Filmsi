<?php

/**
 * FilmArticleTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class FilmArticleTable extends Doctrine_Table
{
	public function updateObjects($articleId, $films)
	{
		Doctrine_Query::create()
			->delete('FilmArticle fa')
			->where('fa.article_id = ?', $articleId)
			->execute();
			
		foreach ($films as $film){
			$filmArticle = new FilmArticle();
			$filmArticle->setArticleId($articleId);
			$filmArticle->setFilmId($film);
			$filmArticle->save();
		}
	}

	public function getRelatedArticles($articleId)
	{
            $films = Doctrine_Query::create()
                    ->from('FilmArticle fa')
                    ->where('fa.article_id = ?', $articleId)
                    ->execute(array(), Doctrine_Core::HYDRATE_ARRAY);
            $filmIds = array();
            foreach($films as $film){
                    $filmIds[] = $film['film_id'];
            }

            $articleIds = array();
            if (count($filmIds) > 0){
                $articles = Doctrine_Query::create()
                        ->from('FilmArticle fa')
                        ->whereIn('fa.film_id', $filmIds)
                        ->execute(array(), Doctrine_Core::HYDRATE_ARRAY);
                foreach($articles as $article){
                        $articleIds[] = $article['article_id'];
                }
            }

            return $articleIds;
	}
}